# プロジェクト開発ルール

## Gitワークフロー

1. **作業ブランチ**:
    * 原則として `main` ブランチでは直接作業を行わないでください。
    * 日常的な開発や修正は `develop` ブランチで行ってください。
    * 大きな機能追加や複雑な変更を行う場合は、`develop` から `feature/xxx` ブランチを作成して作業してください。
2. **作業開始前の確認**:
    * 作業を開始する前に、必ず現在のブランチを確認してください（`git branch`）。意図しないブランチで作業しないよう注意してください。

## コミットメッセージルール

このプロジェクトでは、コミットメッセージに以下のルールを適用します。

### フォーマット

Conventional Commits に従います。

```text
<type>: <description>

[optional body]
```

詳細な説明が必要な場合は、1行空けて記載してください。

### ルール詳細

1. **Prefix (`<type>`)**: 英語を使用する。
    * `feat`: 新機能
    * `fix`: バグ修正
    * `docs`: ドキュメントのみの変更
    * `style`: コードの動作に影響しない変更（空白、フォーマットなど）
    * `refactor`: バグ修正や機能追加を行わないコードの変更
    * `perf`: パフォーマンスを向上させるコードの変更
    * `test`: テストの追加や修正
    * `chore`: ビルドプロセスやドキュメント生成などの補助ツールやライブラリの変更
2. **Description (`<description>`)**: 日本語を使用する。簡潔に内容を記述する。

### 例

* `feat: X Pro用ユーザー非表示Tampermonkeyスクリプトの初期実装`
* `fix: 非表示ロジックのバグを修正`
* `docs: READMEにインストール手順を追加`

## コーディング規約

### JSDoc

クラス、メソッド、複雑な関数には日本語でJSDocコメントを記述してください。

```javascript
/**
 * ユーザーIDリストを整形（トリム＋重複排除）する
 * @param {string[]} ids - 整形するユーザーIDの配列
 * @returns {string[]} 整形済みのユーザーID配列
 */
sanitizeIds (ids) {
  // ...
}
```

### アーキテクチャ

コードは責務ごとにクラスに分割し、`App` クラスが全体のライフサイクルを管理する構成としてください。

* `ConfigManager`: 設定の読み込み・保存
* `FilterEngine`: 判定ロジック
* `App`: アプリケーションの初期化と連携

## 開発ワークフロー

### ビルド

ソースコードは `src/` ディレクトリに分割されています。変更後は必ずビルドしてください。

```bash
# 一度だけビルド
npm run build

# ファイル変更を監視して自動ビルド
npm run watch
```

ビルドされたファイルは `dist/main.js` に出力されます。

### Tampermonkeyへのインストール

1. `npm run build` でビルド
2. `dist/main.js` の内容をTampermonkeyにコピー＆ペースト

### テスト

```bash
npm test
```

## 応答ルール

- このリポジトリに関する回答は必ず日本語で行ってください。
