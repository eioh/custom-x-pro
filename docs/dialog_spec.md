# 設定ダイアログ仕様 (Tampermonkey メニュー)

## 概要
- Tampermonkey メニューからモーダルとして開く設定ダイアログ。背面は操作不可（オーバーレイ）。
- 左側にタブ（ユーザーID / ポストID / キーワード / 設定）、右側にタブ内容を表示。右側は縦スクロール可。
- 各操作は実行時に即時保存。閉じるボタンはダイアログを閉じるのみ。
- リスト表示順は追加順のまま。空リスト時は「データなし」を表示。

## タブごとの仕様
- ユーザーIDタブ
  - 管理対象: hiddenUserIds
  - 追加: 入力欄 + 「追加」ボタン。重複不可。空白/空文字不可。
  - 削除: 各行の「削除」ボタンで1件削除。
  - 表示: 件数 (N件) をタイトル近くに表示。
- ポストIDタブ
  - 管理対象: hiddenPosts
  - 追加: 入力欄 + 「追加」ボタン。追加時に expiresAt を現在時刻 +30日で自動設定。重複不可。空白/空文字不可。
  - 削除: 各行の「削除」ボタンで1件削除。
  - TTL: 起動時に期限切れを削除し保存。マッチ時に expiresAt を +30日で延長し保存。
  - 表示: postId のみ表示し、件数 (N件) をタイトル近くに表示。
- キーワードタブ
  - 管理対象: textFilterWords
  - 追加: 入力時に小文字化し保存。重複不可（大文字違いも同一扱い）。空白/空文字不可。
  - 削除: 各行の「削除」ボタンで1件削除。
  - 判定: 大文字小文字を区別せずに NG 判定する前提。
- 設定タブ
  - インポート行: 「ファイルをインポートする(テキスト)」ラベル + ファイル選択入力 + 「インポート」ボタン。JSON ファイルを選択してボタン押下で取り込み。
  - エクスポート行: 「エクスポート」ラベル + 「エクスポート」ボタン。押下で現在設定を JSON ファイルとしてダウンロード。
  - エラー表示: モーダル内の専用領域に赤字テキストで表示（直近の操作結果を1箇所に集約）。
  - 成功時: エラー表示をクリアし、短いトーストで成功を案内。
  - 任意表示: ファイル名や最新ステータス表示欄を置いてもよい。

## インポート/エクスポート仕様
- フォーマット: version: 2。必須フィールドに hiddenPosts を含む。
- 対象フィールド: hiddenUserIds / hiddenPosts / mediaFilterTargets / textFilterWords。
- インポート:
  - ファイル選択で JSON を読み込み。version が 2 以外、必須欠落、JSON 不正はエラー。
  - hiddenPosts 取り込み時、期限切れはスキップ。取り込み後に即保存し、件数をリフレッシュ。
- エクスポート:
  - 現在の設定を JSON でファイルダウンロード。expiresAt は ISO 8601 (UTC) でそのまま出力。

## バリデーションとフィードバック
- 追加時: 空文字/空白のみは拒否。重複は拒否（キーワードは小文字化後に比較）。
- インポートエラー: モーダル内に赤字表示。部分成功の場合は成功/失敗件数を表示。
- 操作成功: 短いトーストで通知。

## アーキテクチャ対応
- App: ダイアログ開閉、タブ切替、各マネージャ呼び出し。
- ConfigManager: 設定の読み書き、インポート/エクスポート、TTL 処理。
- FilterEngine: 非表示判定ロジック（既存仕様を踏襲）。
- ColumnMediaFilter: 既存仕様に準拠。設定ダイアログでは表示のみ想定。
